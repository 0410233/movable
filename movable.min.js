!function(){const touchable="ontouchstart"in window,events={movestart:touchable?"touchstart":"mousedown",move:touchable?"touchmove":"mousemove",moveend:touchable?"touchend":"mouseup"};function throttle(fn){let ticking=!1;return function(){const args=[].slice.call(arguments);ticking||(window.requestAnimationFrame((function(){fn.apply(null,args),ticking=!1})),ticking=!0)}}function addEvent(event,fn){document.addEventListener(event,fn)}function removeEvent(event,fn){document.removeEventListener(event,fn)}function preventDrag(e){return e.stopPropagation(),e.cancelBubble=!0,touchable||(e.preventDefault(),e.returnValue=!1),!1}function isMouseEvent(e){return e instanceof MouseEvent}function isTouchEvent(e){return null!=typeof TouchEvent&&e instanceof TouchEvent}function getEventPoint(e){return isMouseEvent(e)?e:isTouchEvent(e)?e.touches[0]:{}}function movable(target,onmove){if("string"==typeof target&&(target=document.querySelector(target)),!target instanceof Element)throw"必须指定目标元素";"function"!=typeof onmove&&(target.style.position="fixed",onmove=function(point){const rect=target.getBoundingClientRect();target.style.left=Math.min(Math.max(point.clientX-point.offsetX,0),window.innerWidth-rect.width)+"px",target.style.top=Math.min(Math.max(point.clientY-point.offsetY,0),window.innerHeight-rect.height)+"px"});const offset={},handleMove=throttle((function(e){preventDrag(e);const point=getEventPoint(e);onmove({target:e.target,clientX:point.clientX,clientY:point.clientY,pageX:point.pageX,pageY:point.pageY,screenX:point.screenX,screenY:point.screenY,offsetX:offset.x,offsetY:offset.y})}));function handleStop(){removeEvent(events.move,handleMove),removeEvent(events.moveend,handleStop)}function handleStart(e){if(e.target===target){preventDrag(e);const rect=target.getBoundingClientRect(),point=getEventPoint(e);offset.x=point.clientX-rect.left,offset.y=point.clientY-rect.top,addEvent(events.moveend,handleStop),addEvent(events.move,handleMove)}}return addEvent(events.movestart,handleStart),{stop:function(){removeEvent(events.movestart,handleStart)}}}window.movable=movable}();